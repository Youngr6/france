<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>France Trip 2025 - Cycling Adventure</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./styles/main.css">
    
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Custom JS -->
    <script src="./js/app.js"></script>
</head>
<body>
    <div x-data="tripApp">
        <!-- Loading State -->
        <template x-if="loading">
            <div class="d-flex justify-content-center align-items-center min-vh-100">
                <div class="spinner-border text-light" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </template>

        <!-- Error State -->
        <template x-if="error">
            <div class="container mt-5">
                <div class="alert alert-danger" x-text="error"></div>
            </div>
        </template>

        <!-- Main Content -->
        <template x-if="!loading && !error">
            <div class="container">
                <!-- Header -->
                <div class="header">
                    <h1 x-text="tripInfo.title"></h1>
                    <p x-text="tripInfo.subtitle"></p>
                </div>

                <!-- Days -->
                <template x-for="date in getUniqueDates()" :key="date">
                    <div class="day" :id="'day-' + date" :class="{ 'current-day': isCurrentDay(date) }">
                        <div class="date-column" @click="toggleDay(date)" role="button">
                            <div class="date-header">
                                <div class="date-text" x-text="formatDate(date)"></div>
                                <i class="fas" :class="isDayExpanded(date) ? 'fa-chevron-down' : 'fa-chevron-right'"></i>
                            </div>
                        </div>
                        <div class="content position-relative">
                            <template x-if="!isDayExpanded(date)">
                                <!-- Expand button for collapsed state -->
                                <div class="expand-button d-flex justify-content-center align-items-center p-3" 
                                     @click="toggleDay(date)">
                                    <button class="btn btn-light d-flex align-items-center gap-2">
                                        <i class="fas fa-expand"></i>
                                        Click to expand
                                    </button>
                                </div>
                            </template>
                            <!-- Day content -->
                            <div x-show="isDayExpanded(date)" x-transition>
                                <template x-for="activity in getDayActivities(date)" :key="activity.id">
                                    <div :class="'activity-block ' + activity.type">
                                    <i :class="'fas ' + getActivityIcon(activity) + ' icon'"></i>
                                    <template x-if="activity.time">
                                        <span class="time" x-text="activity.time"></span>
                                    </template>
                                    <strong x-text="activity.title"></strong>
                                    
                                    <!-- Travel Details -->
                                    <template x-if="activity.travel">
                                        <div>
                                            <template x-if="activity.travel.duration">
                                                <div class="time" x-text="activity.travel.duration"></div>
                                            </template>
                                            <template x-if="activity.travel.distance">
                                                <div class="location" x-text="activity.travel.distance"></div>
                                            </template>
                                        </div>
                                    </template>

                                    <!-- Accommodation Details -->
                                    <template x-if="activity.accommodation">
                                        <div class="booking-info">
                                            <template x-if="activity.accommodation.reference">
                                                <div>
                                                    <strong>Ref:</strong>
                                                    <span x-text="activity.accommodation.reference"></span>
                                                </div>
                                            </template>
                                            <template x-if="activity.accommodation.address">
                                                <div class="location" x-text="activity.accommodation.address"></div>
                                            </template>
                                            <template x-if="activity.accommodation.checkOut">
                                                <div>
                                                    <strong>Check-out:</strong>
                                                    <span x-text="activity.accommodation.checkOut"></span>
                                                </div>
                                            </template>
                                            <template x-if="activity.accommodation.price">
                                                <div>
                                                    <span class="highlight" x-text="'€' + activity.accommodation.price"></span>
                                                    <span x-text="activity.accommodation.isPaid ? 'Paid' : 'Not paid'"></span>
                                                    <template x-if="!activity.accommodation.isPaid && activity.accommodation.paidAmount">
                                                        <div class="ms-2">
                                                            <small>
                                                                <span x-text="'€' + activity.accommodation.paidAmount + ' paid'"></span>
                                                                <span x-text="'• €' + activity.accommodation.balanceDue + ' due'"></span>
                                                            </small>
                                                        </div>
                                                    </template>
                                                </div>
                                            </template>
                                            <template x-if="activity.accommodation.includes && activity.accommodation.includes.length">
                                                <div class="mt-1">
                                                    <template x-for="item in activity.accommodation.includes" :key="item">
                                                        <div class="small">
                                                            <i class="fas fa-check text-success me-1"></i>
                                                            <span x-text="item"></span>
                                                        </div>
                                                    </template>
                                                </div>
                                            </template>
                                            <template x-if="activity.accommodation.mapLink">
                                                <div class="mt-2">
                                                    <a :href="activity.accommodation.mapLink" target="_blank" class="d-inline-flex align-items-center">
                                                        <i class="fas fa-map-marker-alt me-2"></i>
                                                        <span>View on Maps</span>
                                                    </a>
                                                </div>
                                            </template>
                                        </div>
                                    </template>

                                    <!-- Cycling Details -->
                                    <template x-if="activity.cycling">
                                        <div>
                                            <template x-if="activity.cycling.distance || activity.cycling.elevation">
                                                <div class="location">
                                                    <template x-if="activity.cycling.distance">
                                                        <span>Distance: <span x-text="activity.cycling.distance + 'km'"></span></span>
                                                    </template>
                                                    <template x-if="activity.cycling.elevation">
                                                        <span class="ms-2">• Elevation: <span x-text="activity.cycling.elevation + 'm'"></span></span>
                                                    </template>
                                                </div>
                                            </template>
                                            <template x-if="activity.cycling.routeLinks && activity.cycling.routeLinks.length">
                                                <div class="mt-2">
                                                    <template x-for="link in activity.cycling.routeLinks" :key="link.url">
                                                        <div>
                                                            <a :href="link.url" target="_blank" class="d-inline-flex align-items-center">
                                                                <i :class="'fab ' + link.icon + ' me-2'"></i>
                                                                <span x-text="link.title"></span>
                                                            </a>
                                                        </div>
                                                    </template>
                                                </div>
                                            </template>
                                        </div>
                                    </template>

                                    <!-- Notes -->
                                    <template x-if="activity.notes && activity.notes.length > 0">
                                        <div class="mt-2">
                                            <template x-for="note in activity.notes" :key="note">
                                                <div class="location" x-html="formatNote(note)"></div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </div>
                </template>
            </div>
        </template>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>